{# core/includes/scripts.html #}
<script src="{% static 'core/js/main.js' %}" defer></script>

<!-- GLightbox CSS/JS -->
<link href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js" defer></script>

<!-- lazysizes for robust lazy-loading -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js" async></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/plugins/attrchange/ls.attrchange.min.js" async></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  // single global lightbox instance
  try {
    window._galleryLightbox = GLightbox({
      selector: '.glightbox',
      touchNavigation: true,
      loop: true
    });
  } catch (e) {
    console.warn('GLightbox init failed', e);
  }

  // reinit helper if DOM changes
  window.reinitGalleryLightbox = function(){
    try { if(window._galleryLightbox) window._galleryLightbox.destroy(); } catch(e){}
    try {
      window._galleryLightbox = GLightbox({ selector: '.glightbox', touchNavigation: true, loop: true });
    } catch (e) { console.warn('GLightbox reinit failed', e); }
  };
});
</script>
